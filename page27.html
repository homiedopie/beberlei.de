<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Blog of Benjamin Eberlei, covering a wide range of programming, bootstrapping and entrepreneurial topics">
        <meta name="viewport" content="width=device-width">
        <meta name="google-site-verification" content="mycr8JCbLYq9QcOyh4Ub1esAdN-awH9ut6nyTKUTgE4">
        <title>Page 27 &mdash; beberlei.de</title>
            <link rel="stylesheet" href="/_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="/_static/css/bootstrap.min.css" type="text/css" />
            <link rel="stylesheet" href="/_static/blog.css" type="text/css" />
            <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" />
        <link rel="shortcut icon" href="_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="_static/plugins.js"></script>
        <script src="_static/main.js"></script>
        <link rel="search" title="Search" href="search.html" /><link rel="next" title="Older" href="page28.html" /><link rel="prev" title="Newer" href="page26.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="_static/underscore.js"></script><script type="text/javascript" src="_static/doctools.js"></script></head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><nav class="navbar navbar-dark">
		  <div class="container">
			  <div class="navbar-header">
				  <a class="navbar-brand" href="https://beberlei.de">Benjamin Eberlei</a>
			  </div>

			  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				  <ul class="nav navbar-nav navbar-right">
						<li><a href="index.html">Home</a></li>
						<li><a href="pages/about.html">About</a></li>
						<li><a href="pages/debugging_php.html">Debugging</a></li>
						<li><a href="pages/imprint.html">Imprint</a></li>
						<li><a href="/archive.html">Archive</a></li>
					  <li><a href="/rss.xml">RSS</a></li>
				  </ul>
			  </div>
		  </div>
		</nav><div class="main-container" role="main"><div class="container">
				<div class="row">
					<div class="col-md-8 col-md-offset-2 col-sm-12"><article role="article">
							<div class="section">
            <h1><a href="2008/12/03/ezcomponents-2008-2-beta-mvc-separation-for-win.html">ezComponents 2008.2 Beta - Mvc separation for win</a></h1>
<p><a class="reference external" href="http://www.whitewashing.de/blog/articles/88">I have written</a> on the
<a class="reference external" href="http://ezcomponents.org">new ezComponents MvcTools</a> component before
already. Just yesterday the beta of this component was released with the
<a class="reference external" href="http://ezcomponents.org/resources/news/news-2008-12-01">general beta of the 2008.2
version</a> of
ezComponents. Several bugfixes and enhancements were included into the
MvcTools which make it a perfect component for any Mvc based
application.</p>
<p>I reviewed lots of the code myself and can only say i love the beauty of
the code. Its very simple but by default the most powerful mvc solution
in the PHP market. People working with unittests will like it very much,
since all the parts are perfectly separated from each other allowing to
test controllers, views, routers and filters in complete separation.</p>
<p>To show one very simple example howto benefit of the separation of view
and controllers. If we need a view in both html and pdf, this should
generally make no difference for the controller. We add two routes, one
for the pdf one for the html view that execute the same controller and
action:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span/><span class="k">class</span> <span class="nc">myRouter</span> <span class="n">extends</span> <span class="n">ezcMvcRouter</span><span class="p">{</span> <span class="n">public</span> <span class="n">function</span> <span class="n">createRoutes</span><span class="p">()</span> <span class="p">{</span>  <span class="k">return</span> <span class="n">array</span><span class="p">(</span>   <span class="n">new</span> <span class="n">ezcMvcRailsRoute</span><span class="p">(</span> <span class="s1">'/pdf'</span><span class="p">,</span> <span class="s1">'SomeController'</span><span class="p">,</span> <span class="s1">'index'</span><span class="p">),</span>   <span class="n">new</span> <span class="n">ezcMvcRailsRoute</span><span class="p">(</span> <span class="s1">'/'</span><span class="p">,</span> <span class="s1">'SomeController'</span><span class="p">,</span> <span class="n">index</span><span class="s1">' ),  ); }}class SomeController extends ezcMvcController{ public function doIndex() {  $result = new ezcMvcResult();  $result-&gt;variables['</span><span class="n">items</span><span class="s1">'] = Model::retrieveLotsOfItems();  return $result; }}</span>
</pre></div>
</div>
</div></blockquote>
<p>Now howto decide between PDF and Html view? We use the createView method
of our dispatcher configuration, but we still only need the http
response writer, nothing more.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span/>class myMvcConfiguration implements ezcMvcDispatcherConfiguration { [...] function createView( ezcMvcRoutingInformation $routeInfo, ezcMvcRequest $request, ezcMvcResult $result ) {  if(strstr($routeInfo-&gt;matchedRoute, "/pdf")) {   return new myHtmlView( $request, $result );  } else {   return new myPdfView( $request, $result );  } } function createResponseWriter( ezcMvcRoutingInformation $routeInfo, ezcMvcRequest $request, ezcMvcResult $result, ezcMvcResponse $response ) {  return new ezcMvcHttpResponseWriter( $response ); } [...]}
</pre></div>
</div>
</div></blockquote>
<p>Now both <strong>myHtmlView</strong> and <strong>myPdfView</strong> can create their
ezcMvcResponse objects that fill the response body depending on their
type. Please note that overwriting createResponseBody() in myPdfView is
a shortcut that circumvents me having to write a new PDF View Handler
(which would be the way to go).</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span/>class myHtmlView extends ezcMvcView { function createZones( $layout ) {  $zones = array();   $zones[] = new ezcMvcPhpViewHandler( 'content', '../templates/index.phtml' );  $zones[] = new ezcMvcPhpViewHandler( 'page_layout', '../templates/layout.phtml' );  return $zones; }}class myPdfView extends ezcMvcView { function createZones() {  // empty, abstract method that has to be defined. } function createResponseBody() {  // Set PDF Content-Type Response Header  $this-&gt;result-&gt;content-&gt;type = "application/pdf";   $pdf = new Zend_Pdf();  // do pdf stuff  return $pdf-&gt;render(); }}
</pre></div>
</div>
</div></blockquote>
<p>Now all the the logic that is potentially in the controller is completely
separated from the view handling that may depend on the routing
information not on the controller. And views can be tested separately
from the controller result. Testability is very high.</p>


            
            <div class="tags">
                More about: 
                <a href="tags/ezcomponents.html">eZComponents</a>
                
                
            </div>
            

            <div class="metadata">
        <p>
            <small>
                Posted on December 03, 2008
                
            </small>
        </p>
    </div>
        </div><div class="separator post_separator"></div><div class="section">
            <h1><a href="2008/12/04/rest-and-ajax-aware-controllers-in-ezcmvctools.html">REST and Ajax Aware controllers in ezcMvcTools</a></h1>
<p>There are essentially two major different ways to implement a restful
application using a web framework. You either implement a router that
routes to different controller actions based on the HTTP method used on
a requested resource. This is the fancy way, which sadly is not always
so practical because many browsers do not support sending more than GET
and POST requests. The other way would be to define suburls of a
resource such as <strong>/user/1/delete</strong> for the resource <strong>/user/1</strong> and
take GET a a request for deleting and POST for the confirmation of the
delete.</p>
<p>ezcMvcTools HTTP Request Parser and routing mechanisms currently offer
no real help to decide on this issues, but its easy to extend this
missing functionality. What we first add are simple checks of the
current http request method. We extend <strong>ezcMvcHttpRequestParser</strong> which
will return a derived <strong>ezcMvcRequest</strong> object that implements 7 new
methods: isPost(), isGet(), isDelete(), isPut(), isXmlHttpRequest(),
isMethod() and getMethod(). These methods can now be easily used on the
request object to determine which action will be undertaken:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span/>class myMvcRequest extends ezcMvcRequest{  public function isPost()  {    return $this-&gt;isMethod("POST");  }  public function isGet()  {    return $this-&gt;isMethod("GET");  }  public function isPut()  {    return $this-&gt;isMethod("PUT");  }  public function isDelete()  {    return $this-&gt;isMethod("DELETE");  }  public function isXmlHttpRequest()  {    if(isset($this-&gt;raw['HTTP_X_REQUESTED_WITH'])      &amp;&amp; strtolower($this-&gt;raw['HTTP_X_REQUESTED_WITH']) == "xmlhttprequest") {      return true;    }    return false;  }    public function getMethod()  {    if(isset($this-&gt;raw['REQUEST_METHOD']))      return strtolower($this-&gt;raw['REQUEST_METHOD']);    }    return false;  }  public function isMethod($method)  {    if(isset($this-&gt;raw['REQUEST_METHOD']) &amp;&amp;       $this-&gt;getMethod() == strtolower($method)) {      return true;    }    return false;  }}class myMvcHttpRequestParser extends ezcMvcHttpRequestParser{  /**   * Uses the data from the superglobals.   *   * @return ezcMvcRequest   */  public function createRequest()  {    $this-&gt;request = new myMvcRequest;    $this-&gt;processStandardHeaders();    $this-&gt;processAcceptHeaders();    $this-&gt;processUserAgentHeaders();    $this-&gt;processFiles();    $this-&gt;processAuthVars();    $this-&gt;request-&gt;raw = &amp;$_SERVER;    return $this-&gt;request;  }}
</pre></div>
</div>
</div></blockquote>
<p>This helps us to implement simple decision mechanisms in a single
controller action that takes both POST and GET requests. From the point
separation of concerns this is not a good design decision. We need
routes that can point to different controller actions based on their
request method, so that two requests <strong>GET /user/1/delete</strong> and <strong>POST
/user/1/delete</strong> lead to different methods, for example
<strong>userController::doDeleteDialog</strong> and <strong>userController::doDelete</strong>. We
will simply extend the <strong>ezcMvcRailsRoute</strong> to support decision based on
http request methods:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span/>class myMvcRestRoute extends ezcMvcRailsRoute{  protected $method;  public function __construct( $method, $pattern, $controllerClassName, $action = null, array $defaultValues = array() )  {    $this-&gt;method = $method;    parent::__construct($pattern, $controllerClassName, $action, $defaultValues);  }  public function matches( ezcMvcRequest $request )  {    if(strtolower($this-&gt;method) == strtolower($request-&gt;raw['REQUEST_METHOD'])) {      return parent::matches($request);    }    return null;  }}
</pre></div>
</div>
</div></blockquote>
<p>This very simple extension is independent of the advanced request parser
given above, so you could use it separately. In the light of our delete
user example, you would use the new router in the following way:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span/><span class="k">class</span> <span class="nc">myRouter</span> <span class="n">extends</span> <span class="n">ezcMvcRouter</span><span class="p">{</span>  <span class="n">public</span> <span class="n">function</span> <span class="n">createRoutes</span><span class="p">()</span>  <span class="p">{</span>    <span class="k">return</span> <span class="n">array</span><span class="p">(</span>      <span class="n">new</span> <span class="n">myMvcRestRoute</span><span class="p">(</span> <span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'/users/:id/delete'</span><span class="p">,</span> <span class="s1">'UserController'</span><span class="p">,</span> <span class="s1">'deleteDialog'</span> <span class="p">),</span>      <span class="n">new</span> <span class="n">myMvcRestRoute</span><span class="p">(</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="s1">'/users/:id/delete'</span><span class="p">,</span> <span class="s1">'UserController'</span><span class="p">,</span> <span class="s1">'delete'</span> <span class="p">),</span>    <span class="p">);</span>  <span class="p">}}</span>
</pre></div>
</div>
</div></blockquote>
<p>We have now simple rest route support in our ezcMvcTools application.</p>


            
            <div class="tags">
                More about: 
                <a href="tags/ezcomponents.html">eZComponents</a>
                
                
            </div>
            

            <div class="metadata">
        <p>
            <small>
                Posted on December 04, 2008
                
            </small>
        </p>
    </div>
        </div><div class="separator post_separator"></div><div class="section">
            <h1><a href="2008/12/12/bad-news-jquery-ui-1-6-ships-without-spinner-and-autocomplete.html">Bad news: jQuery UI 1.6 ships without Spinner and AutoComplete</a></h1>
<p>The jQuery UI team <a class="reference external" href="http://blog.jquery.com/2008/12/11/whats-up-with-jquery-ui/">announced yesterday on its
blog</a> that
<a class="reference external" href="http://ui.jquery.com">jQuery UI 1.6</a> will not be shipped with
AutoComplete and Spinner Plugin support. No further delay, for the
original august 2008 estimated release, is wanted.</p>
<p>This brings about a problem on
<a class="reference external" href="http://framework.zend.com/manual/en/zendx.jquery.html">ZendX_JQuery</a>.
All view helpers and decorators that depend on AutoComplete and Spinner
Plugins can only be run with SVN trunk or 1.6 release candidates, which
have known bugs and problems.</p>
<p>I am adding a compatibility table to the ZendX jQuery manual today that
will make its way to the manual of the 1.7.2 release. This will
hopefully help and guide everyone to the correct dependencies.</p>


            
            <div class="tags">
                More about: 
                <a href="tags/jquery.html">jQuery</a>
                
                
            </div>
            

            <div class="metadata">
        <p>
            <small>
                Posted on December 12, 2008
                
            </small>
        </p>
    </div>
        </div><div class="separator post_separator"></div><div class="section">
            <h1><a href="2008/07/14/jquery-helper-what-is-to-include.html">jQuery Helper - What is to include?</a></h1>
<p>I took some time in the last days to develop the concept for a possible
jQuery View Helper that could pass the integration into the <a class="reference external" href="http://framework.zend.com">ZF
Core</a>. Since
<a class="reference external" href="http://www.jquery.com">jQuery</a> is organized somewhat different than
Dojo is, its possible implementation for ZF will differ.</p>
<p>The jQuery Helper itself will manage inclusion of jQuery javascript
files and the base library, much like the Dojo component works (Using
the Google CDN). On top of this simple Helpers should mimic $.get,
$.post, $.load and $.getJSON in a simple way, so that with a simple
function call you can generate an XmlHttpRequest that updates a
specified part of the DOM (via injection). (See: <a class="reference external" href="http://book.cakephp.org/view/208/ajax">CakePHP
Ajax</a>)</p>
<p>Problematic are the next ideas: Additional Helpers will allow to
specify the <a class="reference external" href="http://ui.jquery.com">jQuery UI Library</a> components
(DatePicker, Sortables, Draggable, Dropable..), <a class="reference external" href="http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/">jQuery
Autocomplete</a>
or <a class="reference external" href="http://malsup.com/jquery/form/">jQuery Form</a> (AjaxForm and
AjaxSubmit). These libraries need additional javascript content to be
downloaded and implemented in the Zend Framework project. There
currently exists no way to implement them using a CDN. Therefore any
documentation must clearly specify which additional content has to be
installed and how. The helpers will have to be general enough to support
this.</p>
<p>My proposal is currently in the workings and will be on the ZF Wiki in
the next couple of hours.</p>


            
            <div class="tags">
                More about: 
                <a href="tags/zendframework.html">ZendFramework</a>
                 / 
                <a href="tags/jquery.html">jQuery</a>
                
                
            </div>
            

            <div class="metadata">
        <p>
            <small>
                Posted on July 14, 2008
                
            </small>
        </p>
    </div>
        </div><div class="separator post_separator"></div><div class="section">
            <h1><a href="2008/07/22/multidimensional-array-via-spl.html">Multidimensional Array via SPL</a></h1>
<p>Per default any implementation of ArrayObject does not allow to use the
object as multidimensional array. This snippet here implements the
support:</p>
<div class="highlight-php"><div class="highlight"><pre><span/><span class="x">class ArrayMultiObject extends ArrayObject</span>
<span class="x">{</span>
<span class="x">    function __construct($array, $flags = 0, $iterator_class = "ArrayIterator")</span>
<span class="x">    {</span>
<span class="x">        $objects = array();</span>
<span class="x">        foreach($array AS $key =&gt; $value) {</span>
<span class="x">            if(is_array($value)) {</span>
<span class="x">                $objects[$key] = new ArrayMultiObject($value, $flags, $iterator_class);</span>
<span class="x">            } else {</span>
<span class="x">                $objects[$key] = $value;</span>
<span class="x">            }</span>
<span class="x">        }</span>

<span class="x">        parent::__construct($objects, $flags, $iterator_class);</span>
<span class="x">    }</span>

<span class="x">    public function offsetSet($name, $value)</span>
<span class="x">    {</span>
<span class="x">        if(is_array($value)) {</span>
<span class="x">            $value = new ArrayMultiObject($value);</span>
<span class="x">        }</span>

<span class="x">        return parent::offsetSet($name, $value);</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
</div>


            
            <div class="tags">
                More about: 
                <a href="tags/php.html">PHP</a>
                
                
            </div>
            

            <div class="metadata">
        <p>
            <small>
                Posted on July 22, 2008
                
            </small>
        </p>
    </div>
        </div><div class="archive_link">
        <a href="archive.html">Archive</a>
    </div></article></div> <!-- #main -->
				</div>
			</div></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo">
			<div class="container">
				<div class="col-md-8 col-md-offset-2">
					<div class="footer">
						<small>© Copyright 2008-2017, Benjamin Eberlei.</small>

						<script type="text/javascript">    var disqus_shortname = "whitewashing";    disqus_count();</script>
					</div>
				</div>
			</div>
        </div> <!-- footer-container -->
      </div> <!--! end of #container --><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->

        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-32146757-1', 'auto');
          ga('send', 'pageview');
        </script>

    </body>
</html>